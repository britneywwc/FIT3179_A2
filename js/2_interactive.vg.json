{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": "800",
  "height": 500,
  "projection": {"type": "equalEarth"},
  "data": {
      "url": "https://raw.githubusercontent.com/britneywwc/FIT3179_A2/main/js/ne_110m_admin_0_countries.topojson",
      "format": {
        "type": "topojson", 
        "feature": "ne_110m_admin_0_countries"
        }
  },        

  "transform": [
    {
      "lookup": "properties.NAME",
      "from": {
        "data": {
          "url": "https://raw.githubusercontent.com/britneywwc/FIT3179_A2/main/coffee/total-production.json"
        },
        "key": "total_production",
        "fields": ["year_2018"]
      }
    },
    {"calculate": "datum.year_2018", "as": "Total Production"}
    
  ],
  "layer":[
      {
        "mark": {
          "type": "geoshape", 
          "fill": "lightgray", 
          "stroke": "white"
          }
      },
      {
      "mark": {"type": "geoshape"},
      "encoding": {
          "color": {
              "field": "Total Production",
              "type": "quantitative",
              "scale": {
                "type": "threshold",
                "range": ["#fdbe85", "#fd8d3c", "#e6550d", "#bd0026", "#7f0000"]
                }
              },
          "tooltip": [
              {"field": "properties.NAME", "type": "nominal", "title": "Country"},
              {"field": "properties.CONTINENT", "type": "nominal", "title": "Continent"},
              {"field": "year_2018", "type": "quantitative", "title": "Production"}
          ]
          }
      },
      {
        "data": {
          "url": "https://raw.githubusercontent.com/britneywwc/FIT3179_A2/main/coffee/location.json"
        },
        "mark": {"type": "text"},
        "encoding": {
          "text": {"field": "country", "type": "nominal"},
          "longitude": {"field": "longitude", "type": "quantitative"},
          "latitude": {"field": "latitude", "type": "quantitative"},
          "color": {"value": "black"},
          "opacity": {
          "condition": {
            "test": "datum['country'] == 'Brazil'||datum['country'] == 'Indonesia' || datum['country'] == 'Mexico' || datum['country'] == 'Zambia' || datum['country'] == 'India'|| datum['country'] == 'Colombia'|| datum['country'] == 'Cameroon'",
            "value": 1
          },
            "value": 0
          } 
        }
      }              
  ]
}